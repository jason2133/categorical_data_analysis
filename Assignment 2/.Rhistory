# Num 1 - a - Relative Risk (RR)
# RR and CI of RR
library(epitools)
riskratio(matrix(c(21, 8, 2, 9), ncol=2), method="wald", conf=0.95, correct=FALSE) #Wald test and CI for Relative Risk(RR)
riskratio(matrix(c(21, 8, 2, 9), ncol=2), method="wald", conf=0.95, correct=FALSE) #Wald test and CI for Relative Risk(RR)
# Num 1 - a - Odds Ratio (OR)
# OR and CI of OR
oddsratio(matrix(c(21, 8, 2, 9), ncol=2), method="wald", conf=0.95, correct=FALSE) #Wald test and CI for Odds Ratio(OR)
# Num 2
num2 <- matrix(c(9, 44, 13, 10, 11, 52, 23, 22, 9, 41, 12, 27), ncol = 3)
num2
chisq.test(num2)
chisq.test(num2)
likelihood.test(num2)
data(num2)
library(DescTools)
GTest(num2, correct="none")  #Likelihood-ratio(LR) test
library(DescTools)
GTest(num2, correct="none")  #Likelihood-ratio(LR) test
# 과제 문제 1번 Num 1
num1 <- matrix(c(21, 8, 2, 9), ncol = 2)
num1
# Num 1 - a - proportions(D)
# D and CI of D
prop.test(num1, conf.level=0.95, correct=FALSE) #Wald test and CI for diff props(D)
# Num 1 - a - Relative Risk (RR)
# RR and CI of RR
library(epitools)
riskratio(matrix(c(21, 8, 2, 9), ncol=2), method="wald", conf=0.95, correct=FALSE) #Wald test and CI for Relative Risk(RR)
riskratio(matrix(c(21, 8, 2, 9), ncol=2), method="wald", conf=0.95, correct=FALSE) #Wald test and CI for Relative Risk(RR)
# Num 1 - a - Odds Ratio (OR)
# OR and CI of OR
oddsratio(matrix(c(21, 8, 2, 9), ncol=2), method="wald", conf=0.95, correct=FALSE) #Wald test and CI for Odds Ratio(OR)
library(epitools)
riskratio(matrix(c(189, 104, 10845, 10933), ncol=2), method="wald", conf=0.95, correct=FALSE) #Wald test and CI for Relative Risk(RR)
riskratio(matrix(c(189, 104, 10845, 10933), ncol=2), method="wald", conf=0.95, correct=FALSE) #Wald test and CI for Relative Risk(RR)
library(PropCIs)
diffscoreci(189, 11034, 104, 11037, conf.level=0.95) #Score CI for D
riskscoreci(189, 11034, 104, 11037, conf.level=0.95) #Score CI for RR
orscoreci(189, 11034, 104, 11037, conf.level=0.95) #Score CI for OR
library(PropCIs)
diffscoreci(21, 23, 8, 17, conf.level=0.95) #Score CI for D
riskscoreci(21, 23, 8, 17, conf.level=0.95) #Score CI for RR
orscoreci(21, 23, 8, 17, conf.level=0.95) #Score CI for OR
# Num 1 - a - Odds Ratio (OR)
# OR and CI of OR
oddsratio(matrix(c(21, 8, 2, 9), ncol=2), method="wald", conf=0.95, correct=FALSE) #Wald test and CI for Odds Ratio(OR)
# Num 1 - a - Relative Risk (RR)
# RR and CI of RR
library(epitools)
riskratio(c(9, 8, 2, 21), method="wald", conf=0.95, correct=FALSE) #Wald test and CI for Relative Risk(RR)
riskratio(c(8, 9, 21, 2), method="wald", conf=0.95, correct=FALSE) #Wald test and CI for Relative Risk(RR)
oddsratio(c(21, 2, 8, 9), method="wald", conf=0.95, correct=FALSE) #Wald test and CI
# proportions(D)
prop.test(num1, conf.level=0.95, correct=FALSE) #Wald test and CI for diff props(D)
library(PropCIs)
diffscoreci(21, 23, 8, 17, conf.level=0.95) #Score CI for D
riskscoreci(21, 23, 8, 17, conf.level=0.95) #Score CI for RR
orscoreci(21, 23, 8, 17, conf.level=0.95) #Score CI for OR
# Num 1 - a - Relative Risk (RR)
# RR and CI of RR
library(epitools)
riskratio(c(9, 8, 2, 21), method="wald", conf=0.95, correct=FALSE) #Wald test and CI for Relative Risk(RR)
riskratio(c(8, 9, 21, 2), method="wald", conf=0.95, correct=FALSE) #Wald test and CI for Relative Risk(RR)
oddsratio(c(21, 2, 8, 9), method="wald", conf=0.95, correct=FALSE) #Wald test and CI for OR
riskratio(c(10933, 104, 10845, 189), method="wald", conf=0.95, correct=FALSE) #Wald test and CI for Relative Risk(RR)
# Relative Risk (RR)
library(epitools)
riskratio(c(9, 8, 2, 21), method="wald", conf=0.95, correct=FALSE) #Wald test and CI for Relative Risk(RR)
library(epitools)
riskratio(c(10933, 104, 10845, 189), method="wald", conf=0.95, correct=FALSE) #Wald test and CI for Relative Risk(RR)
riskratio(c(104, 10933, 189, 10845), method="wald", conf=0.95, correct=FALSE) #Wald test and CI for Relative Risk(RR)
oddsratio(c(189, 10845, 104, 10933), method="wald", conf=0.95, correct=FALSE) #Wald test and CI for Odds Ratio(OR)
# Num 1 - a - Relative Risk (RR)
# RR and CI of RR
library(epitools)
riskratio(c(9, 8, 2, 21), method="wald", conf=0.95, correct=FALSE) #Wald test and CI for Relative Risk(RR)
riskratio(c(8, 9, 21, 2), method="wald", conf=0.95, correct=FALSE) #Wald test and CI for Relative Risk(RR)
# proportions(D)
prop.test(num1, conf.level=0.95, correct=FALSE) #Wald test and CI for diff props(D)
# Relative Risk (RR)
library(epitools)
riskratio(c(9, 8, 2, 21), method="wald", conf=0.95, correct=FALSE) #Wald test and CI for Relative Risk(RR)
oddsratio(c(21, 2, 8, 9), method="wald", conf=0.95, correct=FALSE) #Wald test and CI for OR
# OR (Odds Ratio)
oddsratio(c(21, 2, 8, 9), method="wald", conf=0.95, correct=FALSE) #Wald test and CI for OR
# Num 1
num1 <- matrix(c(21, 8, 2, 9), ncol = 2)
num1
###Analysis of tea data
tea <- matrix(c(3, 1, 1, 3), ncol=2)
tea
fisher.test(tea)                        #Fisher's exact test
fisher.test(tea, alternative="greater") #Fisher's exact test (one-sided)
###Analysis of tea data
fisher.test(num1)                        #Fisher's exact test
fisher.test(num1, alternative="greater") #Fisher's exact test (one-sided)
chisq.test(num1) #Pearson's chi-square test
#Other political gender gap data
GenderGap2 <- matrix(c(762, 484, 327, 239, 468, 477), ncol=3)
GenderGap2 <- data.frame(GenderGap2, row.names=c("female", "male"))
colnames(GenderGap2) <- c("Dem", "Rep", "Ind")
GenderGap2
chisq.test(GenderGap2) #Pearson's chi-square test
stdres <- chisq.test(GenderGap2)$stdres #standardized residuals
stdres
library(DescTools)
GTest(GenderGap2)  #Likelihood-ratio(LR) test
# Num 1 againn
#Other political gender gap data
num1again <- matrix(c(21, 8, 2, 9), ncol=2)
num1again <- data.frame(num1again, row.names=c("Surgery", "Radiation Therapy"))
colnames(num1again) <- c("Controlled", "Not Controlled")
num1again
num1again
chisq.test(num1again) #Pearson's chi-square test
stdres <- chisq.test(GenderGap2)$stdres #standardized residuals
stdres
chisq.test(num1again) #Pearson's chi-square test
GTest(num1again)
# c
fisher.test(num1)                        #Fisher's exact test
fisher.test(num1, alternative="greater") #Fisher's exact test (one-sided)
# c
fisher.test(num1again)                        #Fisher's exact test
# c
fisher.test(num1again)                        #Fisher's exact test
fisher.test(num1again, alternative="greater") #Fisher's exact test (one-sided)
chisq.test(num1again) #Pearson's chi-square test
GTest(num1again)
library(DescTools)
# Num 2
# a
num2again <- matrix(c(9, 4, 13, 10, 11, 52, 23, 22, 9, 41, 12, 27), ncol=3)
num2again <- data.frame(num2again, row.names=c("some high school", "high school graduate", "some college", "college graduate"))
colnames(num2again) <- c("low", "middle", "high")
num2again
# a
chisq.test(num2again)
library(DescTools)
GTest(num2again) # LR Test
library(DescTools)
GTest(num1again) # LR Test
install.packages("PropCIs")
install.packages("epitools")
install.packages("vcd")
install.packages("vcdExtra")
install.packages("DescTools")
# Num 1
num1 <- matrix(c(21, 8, 2, 9), ncol = 2)
num1
# proportions(D)
prop.test(num1, conf.level=0.95, correct=FALSE) #Wald test and CI for diff props(D)
# Relative Risk (RR)
library(epitools)
riskratio(c(9, 8, 2, 21), method="wald", conf=0.95, correct=FALSE) #Wald test and CI for Relative Risk(RR)
# OR (Odds Ratio)
oddsratio(c(21, 2, 8, 9), method="wald", conf=0.95, correct=FALSE) #Wald test and CI for OR
# b
num1again <- matrix(c(21, 8, 2, 9), ncol=2)
num1again <- data.frame(num1again, row.names=c("Surgery", "Radiation Therapy"))
colnames(num1again) <- c("Controlled", "Not Controlled")
num1again
chisq.test(num1again) #Pearson's chi-square test
library(DescTools)
GTest(num1again) # LR Test
library(DescTools)
GTest(num1again) # LR Test
# 표준화잔차
num2residual <- chisq.test(num2again)$stdres
num2residual
library(DescTools)
GTest(num2again) # LR Test
library(DescTools)
GTest(num1again) # LR Test
library(DescTools)
GTest(num2again) # LR Test
abc <- matrix(c(762, 484, 327, 239, 468, 477), ncol = 3)
abc <- matrix(c(762, 484, 327, 239, 468, 477), ncol = 3)
abcd <- chisq.test(abc)$stdres
abcd
num2again
# Num 2
# a
num2again <- matrix(c(9, 44, 13, 10, 11, 52, 23, 22, 9, 41, 12, 27), ncol=3)
num2again <- data.frame(num2again, row.names=c("some high school", "high school graduate", "some college", "college graduate"))
colnames(num2again) <- c("low", "middle", "high")
num2again
# a
chisq.test(num2again)
library(DescTools)
GTest(num2again) # LR Test
# 표준화잔차
num2residual <- chisq.test(num2again)$stdres
num2residual
# b
# 기대도수, 표준화잔차
num2expect <- chisq.test(num2again)$expected
num2expect
#Analysis of infant malformation data
Malform <- matrix(c(17066, 14464, 788, 126, 37, 48, 38, 5, 1, 1), ncol=2)
library(vcdExtra)
sqrt(6.5699)
1-pnorm(2.56318)
CMHtest(Malform, rscores=c(0, 0.5, 1.5, 4.0, 7.0)) #M-test
CMHtest(Malform, rscores=c(0, 0.5, 1.5, 4.0, 7.0)) #M-test
#Analysis of infant malformation data
Malform <- matrix(c(17066, 14464, 788, 126, 37, 48, 38, 5, 1, 1), ncol=2)
Malform
library(vcdExtra)
CMHtest(Malform, rscores=c(0, 0.5, 1.5, 4.0, 7.0)) #M-test
# 4
# a
# OR 6
# AG Conditional OR
oddsratio(c(189, 10845, 104, 10933), method="wald", conf=0.95, correct=FALSE) #Wald test and CI for Odds Ratio(OR)
# 4
# a
# OR 6
# AG Conditional OR
library(epitools)
oddsratio(c(189, 10845, 104, 10933), method="wald", conf=0.95, correct=FALSE) #Wald test and CI for Odds Ratio(OR)
# 4
# a
# OR 6
# AG Conditional OR
library(epitools)
oddsratio(c(189, 10845, 104, 10933), method="wald", conf=0.95, correct=FALSE) #Wald test and CI for Odds Ratio(OR)
library(epitools)
riskratio(c(10933, 104, 10845, 189), method="wald", conf=0.95, correct=FALSE) #Wald test and CI for Relative Risk(RR)
riskratio(c(104, 10933, 189, 10845), method="wald", conf=0.95, correct=FALSE) #Wald test and CI for Relative Risk(RR)
oddsratio(c(189, 10845, 104, 10933), method="wald", conf=0.95, correct=FALSE) #Wald test and CI for Odds Ratio(OR)
library(PropCIs)
diffscoreci(189, 11034, 104, 11037, conf.level=0.95) #Score CI for D
riskscoreci(189, 11034, 104, 11037, conf.level=0.95) #Score CI for RR
orscoreci(189, 11034, 104, 11037, conf.level=0.95) #Score CI for OR
# 4
# a
# OR 6
# AG Conditional OR
library(epitools)
oddsratio(matrix(c(189, 10845, 104, 10933), ncol=2), method="wald", conf=0.95, correct=FALSE) #Wald test and CI for Odds Ratio(OR)
install.packages("PropCIs")
install.packages("epitools")
install.packages("vcd")
install.packages("PropCIs")
install.packages("vcdExtra")
install.packages("DescTools")
###Analysis of MI data
prop.test(c(189, 104), c(11034, 11037), conf.level=0.95, correct=FALSE) #Wald test and CI for diff props(D)
library(epitools)
riskratio(c(10933, 104, 10845, 189), method="wald", conf=0.95, correct=FALSE) #Wald test and CI for Relative Risk(RR)
riskratio(c(104, 10933, 189, 10845), method="wald", conf=0.95, correct=FALSE) #Wald test and CI for Relative Risk(RR)
oddsratio(c(189, 10845, 104, 10933), method="wald", conf=0.95, correct=FALSE) #Wald test and CI for Odds Ratio(OR)
# 4
# a
# OR 6
# AG Conditional OR
library(epitools)
oddsratio(c(189, 10845, 104, 10933), method="wald", conf=0.95, correct=FALSE) #Wald test and CI for Odds Ratio(OR)
# 4
# a
# OR 6
# AG Conditional OR
library(epitools)
oddsratio(c(512, 313, 89, 19), method="wald", conf=0.95, correct=FALSE) #Wald test and CI for Odds Ratio(OR)
# Department 1
oddsratio(c(512, 313, 89, 19), method="wald", conf=0.95, correct=FALSE) #Wald test and CI for Odds Ratio(OR)
# Department 2
oddsratio(c(353, 207, 17, 8), method="wald", conf=0.95, correct=FALSE) #Wald test and CI for Odds Ratio(OR)
# Department 3
oddsratio(c(120, 205, 202, 391), method="wald", conf=0.95, correct=FALSE) #Wald test and CI for Odds Ratio(OR)
# Department 4
oddsratio(c(138, 279, 131, 244), method="wald", conf=0.95, correct=FALSE) #Wald test and CI for Odds Ratio(OR)
# Department 5
oddsratio(c(53, 138, 94, 299), method="wald", conf=0.95, correct=FALSE) #Wald test and CI for Odds Ratio(OR)
# Department 6
oddsratio(c(22, 351, 24, 317), method="wald", conf=0.95, correct=FALSE) #Wald test and CI for Odds Ratio(OR)
# b
# AG marginal OR
oddsratio(c(1198, 1493, 557, 1278), method="wald", conf=0.95, correct=FALSE) #Wald test and CI for Odds Ratio(OR)
#Analysis of infant malformation data
Malform <- matrix(c(17066, 14464, 788, 126, 37, 48, 38, 5, 1, 1), ncol=2)
Malform
library(vcdExtra)
CMHtest(Malform, rscores=c(0, 0.5, 1.5, 4.0, 7.0)) #M-test
sqrt(6.5699)
1-pnorm(2.56318)
cor(CMHtest)
# 3
# a
num3 <- matrix(c(9, 44, 13, 10, 11, 52, 23, 22, 9, 41, 12, 27), ncol=3)
num3
library(vcdExtra)
library(vcdExtra)
CMHtest(num3, rscores=c(1, 2, 3, 4), cscores = (1, 2, 3)) #M-test
library(vcdExtra)
CMHtest(num3, rscores=c(1, 2, 3, 4), cscores = c(1, 2, 3)) #M-test
sqrt(4.7489)
sqrt(4.7489)
1-pnorm(2.179197)
CMHtest(num3, rscores=c(10, 20, 30, 40), cscores = c(-1, 0, 1)) #M-test
sqrt(4.7489)
1-pnorm(2.179197)
# c
library(vcdExtra)
CMHtest(num3, rscores=c(1, 3, 5, 10), cscores = c(1, 5, 10)) #M-test
sqrt(6.0867)
1-pnorm(2.467124)
# Num 1
num1 <- matrix(c(21, 8, 2, 9), ncol = 2)
num1
# proportions(D)
prop.test(num1, conf.level=0.95, correct=FALSE) #Wald test and CI for diff props(D)
# Relative Risk (RR)
library(epitools)
riskratio(c(9, 8, 2, 21), method="wald", conf=0.95, correct=FALSE) #Wald test and CI for Relative Risk(RR)
# OR (Odds Ratio)
oddsratio(c(21, 2, 8, 9), method="wald", conf=0.95, correct=FALSE) #Wald test and CI for OR
# b
num1again <- matrix(c(21, 8, 2, 9), ncol=2)
num1again <- data.frame(num1again, row.names=c("Surgery", "Radiation Therapy"))
colnames(num1again) <- c("Controlled", "Not Controlled")
# 4
# a
# OR 6
# AG Conditional OR
library(epitools)
# Department 1
oddsratio(c(512, 313, 89, 19), method="wald", conf=0.95, correct=FALSE) #Wald test and CI for Odds Ratio(OR)
# Department 2
oddsratio(c(353, 207, 17, 8), method="wald", conf=0.95, correct=FALSE) #Wald test and CI for Odds Ratio(OR)
# Department 3
oddsratio(c(120, 205, 202, 391), method="wald", conf=0.95, correct=FALSE) #Wald test and CI for Odds Ratio(OR)
# Department 4
oddsratio(c(138, 279, 131, 244), method="wald", conf=0.95, correct=FALSE) #Wald test and CI for Odds Ratio(OR)
# Department 5
oddsratio(c(53, 138, 94, 299), method="wald", conf=0.95, correct=FALSE) #Wald test and CI for Odds Ratio(OR)
# Department 6
oddsratio(c(22, 351, 24, 317), method="wald", conf=0.95, correct=FALSE) #Wald test and CI for Odds Ratio(OR)
# b
# AG Marginal OR
oddsratio(c(1198, 1493, 557, 1278), method="wald", conf=0.95, correct=FALSE) #Wald test and CI for Odds Ratio(OR)
# c
# c
# AG Conditional OR
LogR_risk<-function(x,a){
conf_int<- c(0,0)
N<-c(sum(x[1,]),sum(x[2,]))
p<-prop.test( x, conf.level=1-a)$estimate
conf_int[1] <- log(p[1]/p[2])-qnorm(1-a/2, 0,1)*sqrt((1-p[1])/(N[1]*p[1])+((1-p[2])/N[2]*p[2]))
conf_int[2] <- log(p[1]/p[2])+qnorm(1-a/2, 0,1)*sqrt((1-p[1])/(N[1]*p[1])+((1-p[2])/N[2]*p[2]))
return(conf_int)
}
gazua1 <- matrix(c(21, 8, 2, 9), ncol = 2)
gazua1
LogR_risk<-function(x,a){
conf_int<- c(0,0)
N<-c(sum(x[1,]),sum(x[2,]))
p<-prop.test( x, conf.level=1-a)$estimate
conf_int[1] <- log(p[1]/p[2])-qnorm(1-a/2, 0,1)*sqrt((1-p[1])/(N[1]*p[1])+((1-p[2])/N[2]*p[2]))
conf_int[2] <- log(p[1]/p[2])+qnorm(1-a/2, 0,1)*sqrt((1-p[1])/(N[1]*p[1])+((1-p[2])/N[2]*p[2]))
return(conf_int)
}
LogR_risk(gazua1, 0.1)
LogR_risk(gazua1, 0.05)
install.packages("epiR")
library(epiR)
gazua1 <- matrix(c(21, 8, 2, 9), ncol = 2)
gazua1
epi.2by2(gazua1,method="cohort.count",conf.level=0.95)
help(package="epiR")
# Num 2
# a
num2again <- matrix(c(9, 44, 13, 10, 11, 52, 23, 22, 9, 41, 12, 27), ncol=3)
num2again <- data.frame(num2again, row.names=c("some high school", "high school graduate", "some college", "college graduate"))
colnames(num2again) <- c("low", "middle", "high")
num2again
# a
chisq.test(num2again) # Chi-Squared Test
library(DescTools)
GTest(num2again) # LR Test
# 기대도수
# Estimated Expected Frequencies
num2expect <- chisq.test(num2again)$expected
num2expect
# 표준화잔차
# Standardized Pearson Residuals
num2residual <- chisq.test(num2again)$stdres
num2residual
# 3
# a
num3 <- matrix(c(9, 44, 13, 10, 11, 52, 23, 22, 9, 41, 12, 27), ncol=3)
# OR (Odds Ratio)
oddsratio(c(21, 2, 8, 9), method="wald", conf=0.95, correct=FALSE) #Wald test and CI for OR
# OR (Odds Ratio)
oddsratio(c(21, 2, 8, 9), method="wald", conf=0.95, correct=FALSE) #Wald test and CI for OR
# Relative Risk (RR)
library(epitools)
riskratio(c(9, 8, 2, 21), method="wald", conf=0.95, correct=FALSE) #Wald test and CI for Relative Risk(RR)
# b
num1again <- matrix(c(21, 8, 2, 9), ncol=2)
num1again <- data.frame(num1again, row.names=c("Surgery", "Radiation Therapy"))
colnames(num1again) <- c("Controlled", "Not Controlled")
num1again
chisq.test(num1again) #Pearson's chi-square test
num1expect <- chisq.test(num1again)$expected
num1expect
chisq.test(num1again) #Pearson's chi-square test
library(DescTools)
GTest(num1again) # LR Test
# c
fisher.test(num1again)                        #Fisher's exact test
fisher.test(num1again, alternative="greater") #Fisher's exact test (one-sided)
###Analysis of tea data
tea <- matrix(c(3, 1, 1, 3), ncol=2)
tea
fisher.test(tea)                        #Fisher's exact test
fisher.test(tea, alternative="greater") #Fisher's exact test (one-sided)
# b
num1again <- matrix(c(21, 8, 2, 9), ncol=2)
num1again <- data.frame(num1again, row.names=c("Surgery", "Radiation Therapy"))
colnames(num1again) <- c("Controlled", "Not Controlled")
num1again
num1expect <- chisq.test(num1again)$expected
num1expect
chisq.test(num1again) #Pearson's chi-square test
library(DescTools)
GTest(num1again) # LR Test
# c
fisher.test(num1again)                        #Fisher's exact test
fisher.test(num1again, alternative="greater") #Fisher's exact test (one-sided)
# Num 2
# a
num2again <- matrix(c(9, 44, 13, 10, 11, 52, 23, 22, 9, 41, 12, 27), ncol=3)
num2again <- data.frame(num2again, row.names=c("some high school", "high school graduate", "some college", "college graduate"))
colnames(num2again) <- c("low", "middle", "high")
num2again
# a
chisq.test(num2again) # Chi-Squared Test
library(DescTools)
GTest(num2again) # LR Test
# 기대도수
# Estimated Expected Frequencies
num2expect <- chisq.test(num2again)$expected
num2expect
# 표준화잔차
# Standardized Pearson Residuals
num2residual <- chisq.test(num2again)$stdres
num2residual
# 3
# a
num3 <- matrix(c(9, 44, 13, 10, 11, 52, 23, 22, 9, 41, 12, 27), ncol=3)
num3
library(vcdExtra)
CMHtest(num3, rscores=c(1, 2, 3, 4), cscores = c(1, 2, 3)) #M-test
sqrt(4.7489)
1-pnorm(2.179197)
# b
library(vcdExtra)
CMHtest(num3, rscores=c(10, 20, 30, 40), cscores = c(-1, 0, 1)) #M-test
sqrt(4.7489)
1-pnorm(2.179197)
# c
library(vcdExtra)
CMHtest(num3, rscores=c(1, 3, 5, 10), cscores = c(1, 5, 10)) #M-test
sqrt(6.0867)
1-pnorm(2.467124)
library(vcdExtra)
CMHtest(num3)
CMHtest(num3, rscores=c(1, 2, 3, 4), cscores = c(1, 2, 3)) #M-test
#Analysis of infant malformation data
Malform <- matrix(c(17066, 14464, 788, 126, 37, 48, 38, 5, 1, 1), ncol=2)
Malform
library(vcdExtra)
CMHtest(Malform, rscores=c(0, 0.5, 1.5, 4.0, 7.0)) #M-test
sqrt(6.5699)
1-pnorm(2.56318)
help(vcdExtra)
# c
library(vcdExtra)
CMHtest(num3, rscores=c(1, 3, 5, 10), cscores = c(1, 5, 10)) #M-test
sqrt(6.0867)
1-pnorm(2.467124)
# b
library(vcdExtra)
CMHtest(num3, rscores=c(10, 20, 30, 40), cscores = c(-1, 0, 1)) #M-test
sqrt(4.7489)
1-pnorm(2.179197)
# c
library(vcdExtra)
CMHtest(num3, rscores=c(1, 3, 5, 10), cscores = c(1, 5, 10)) #M-test
sqrt(6.0867)
1-pnorm(2.467124)
# > oddsratio(c(21, 2, 8, 9), method="wald", conf=0.95, correct=FALSE) #Wald test and CI for OR
oddsratio(c(9, 11, 9, 44, 52, 41, 13, 23, 12, 10, 22, 27), method='wald', conf=0.95, correct=FALSE)
# Relative Risk (RR)
library(epitools)
riskratio(c(9, 8, 2, 21), method="wald", conf=0.95, correct=FALSE) #Wald test and CI for Relative Risk(RR)
# OR (Odds Ratio)
oddsratio(c(21, 2, 8, 9), method="wald", conf=0.95, correct=FALSE) #Wald test and CI for OR
# c
# OR from the cells at the 4 corners
oddsratio(c(9, 11, 9, 44, 52, 41, 13, 23, 12, 10, 22, 27), method='wald', conf=0.95, correct=FALSE)
oddsratio(num2again, method='wald', conf=0.95, correct=FALSE)
oddsratio(num2again, method='wald', conf=0.95, correct=FALSE)
oddsratio(num2again, method='wald', conf=0.95, correct=FALSE)
oddsratio(num2again, method='wald', conf=0.95, correct=FALSE)
oddsratio(matrix(c(9, 11, 9, 44, 52, 41, 13, 23, 12, 10, 22, 27), nrow=3), method='wald', conf=0.95, correct=FALSE)
# c
# OR from the cells at the 4 corners
oddsratio(matrix(c(9, 11, 9, 44, 52, 41, 13, 23, 12, 10, 22, 27), nrow=3), method='wald', conf=0.95, correct=FALSE)
